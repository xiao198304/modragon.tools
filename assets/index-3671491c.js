import{c as fe,g as ve,d as Z,u as ee,e as D,f as k,o as _,h as C,j as h,t as p,k as l,w as i,l as S,m as c,q as z,F as L,n as se,p as V,v as re,x as O,y as J,z as le,A as G,W as K,B as Q,C as P,D as _e,E as X,G as ue,H as te,I as W,J as pe,K as ye,L as we,M as xe,N as ie,O as de,P as ce,Q as j,R as ge,S as $e,T as ke}from"./index-7780ba5e.js";var he={exports:{}};(function(U,M){(function(n,m){U.exports=m()})(fe,function(){var n,m,B=1e3,d=6e4,E=36e5,T=864e5,u=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,A=31536e6,w=2592e6,Y=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,x={years:A,months:w,days:T,hours:E,minutes:d,seconds:B,milliseconds:1,weeks:6048e5},H=function(r){return r instanceof a},N=function(r,s,e){return new a(r,e,s.$l)},R=function(r){return m.p(r)+"s"},b=function(r){return r<0},o=function(r){return b(r)?Math.ceil(r):Math.floor(r)},f=function(r){return Math.abs(r)},t=function(r,s){return r?b(r)?{negative:!0,format:""+f(r)+s}:{negative:!1,format:""+r+s}:{negative:!1,format:""}},a=function(){function r(e,g,y){var $=this;if(this.$d={},this.$l=y,e===void 0&&(this.$ms=0,this.parseFromMilliseconds()),g)return N(e*x[R(g)],this);if(typeof e=="number")return this.$ms=e,this.parseFromMilliseconds(),this;if(typeof e=="object")return Object.keys(e).forEach(function(q){$.$d[R(q)]=e[q]}),this.calMilliseconds(),this;if(typeof e=="string"){var I=e.match(Y);if(I){var F=I.slice(2).map(function(q){return q!=null?Number(q):0});return this.$d.years=F[0],this.$d.months=F[1],this.$d.weeks=F[2],this.$d.days=F[3],this.$d.hours=F[4],this.$d.minutes=F[5],this.$d.seconds=F[6],this.calMilliseconds(),this}}return this}var s=r.prototype;return s.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(g,y){return g+(e.$d[y]||0)*x[y]},0)},s.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=o(e/A),e%=A,this.$d.months=o(e/w),e%=w,this.$d.days=o(e/T),e%=T,this.$d.hours=o(e/E),e%=E,this.$d.minutes=o(e/d),e%=d,this.$d.seconds=o(e/B),e%=B,this.$d.milliseconds=e},s.toISOString=function(){var e=t(this.$d.years,"Y"),g=t(this.$d.months,"M"),y=+this.$d.days||0;this.$d.weeks&&(y+=7*this.$d.weeks);var $=t(y,"D"),I=t(this.$d.hours,"H"),F=t(this.$d.minutes,"M"),q=this.$d.seconds||0;this.$d.milliseconds&&(q+=this.$d.milliseconds/1e3);var v=t(q,"S"),ae=e.negative||g.negative||$.negative||I.negative||F.negative||v.negative,me=I.format||F.format||v.format?"T":"",oe=(ae?"-":"")+"P"+e.format+g.format+$.format+me+I.format+F.format+v.format;return oe==="P"||oe==="-P"?"P0D":oe},s.toJSON=function(){return this.toISOString()},s.format=function(e){var g=e||"YYYY-MM-DDTHH:mm:ss",y={Y:this.$d.years,YY:m.s(this.$d.years,2,"0"),YYYY:m.s(this.$d.years,4,"0"),M:this.$d.months,MM:m.s(this.$d.months,2,"0"),D:this.$d.days,DD:m.s(this.$d.days,2,"0"),H:this.$d.hours,HH:m.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:m.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:m.s(this.$d.seconds,2,"0"),SSS:m.s(this.$d.milliseconds,3,"0")};return g.replace(u,function($,I){return I||String(y[$])})},s.as=function(e){return this.$ms/x[R(e)]},s.get=function(e){var g=this.$ms,y=R(e);return y==="milliseconds"?g%=1e3:g=y==="weeks"?o(g/x[y]):this.$d[y],g===0?0:g},s.add=function(e,g,y){var $;return $=g?e*x[R(g)]:H(e)?e.$ms:N(e,this).$ms,N(this.$ms+$*(y?-1:1),this)},s.subtract=function(e,g){return this.add(e,g,!0)},s.locale=function(e){var g=this.clone();return g.$l=e,g},s.clone=function(){return N(this.$ms,this)},s.humanize=function(e){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},s.milliseconds=function(){return this.get("milliseconds")},s.asMilliseconds=function(){return this.as("milliseconds")},s.seconds=function(){return this.get("seconds")},s.asSeconds=function(){return this.as("seconds")},s.minutes=function(){return this.get("minutes")},s.asMinutes=function(){return this.as("minutes")},s.hours=function(){return this.get("hours")},s.asHours=function(){return this.as("hours")},s.days=function(){return this.get("days")},s.asDays=function(){return this.as("days")},s.weeks=function(){return this.get("weeks")},s.asWeeks=function(){return this.as("weeks")},s.months=function(){return this.get("months")},s.asMonths=function(){return this.as("months")},s.years=function(){return this.get("years")},s.asYears=function(){return this.as("years")},r}();return function(r,s,e){n=e,m=e().$utils(),e.duration=function($,I){var F=e.locale();return N($,{$l:F},I)},e.isDuration=H;var g=s.prototype.add,y=s.prototype.subtract;s.prototype.add=function($,I){return H($)&&($=$.asMilliseconds()),g.bind(this)($,I)},s.prototype.subtract=function($,I){return H($)&&($=$.asMilliseconds()),y.bind(this)($,I)}}})})(he);var be=he.exports;const Se=ve(be),Ae={class:"mr-1"},Ce={class:"text-gray-500 text-sm"},Ee={class:"text-gray-500 text-sm ml-1"},Ie={key:0},Te={key:1,class:"m-2"},Me={key:2},De=h("span",{class:"text-gray-500"},"ETH",-1),ne=Z({__name:"DragonNft",props:{dragon:{},isShowTransfer:{type:Boolean}},emits:["onRefresh"],setup(U,{emit:M}){const{dragon:n,isShowTransfer:m=!0}=U,B=xe,d=ee(),E=D(!1),T=D(""),u=()=>{E.value=!0},A=D(!1),w=D(1),Y=()=>{A.value=!0},x=D(!1),H=D([{text:"",value:"",disabled:!0}]),N=()=>{let t=[];for(let a=0;a<d.address.length;a++){let r=d.address[a].nickname+" "+le(d.address[a].address),s=d.address[a].address,e=!1;a==d.changeAddressIndex&&(e=!0,r+=" <发送地址>"),t.push({text:r,value:s,disabled:e})}H.value=t,x.value=!0},R=({selectedValues:t})=>{T.value=t[0],x.value=!1},b=async()=>{G({duration:0,message:"开蛋抽券中"});let t=d.address[d.changeAddressIndex].address.toLowerCase(),r="dragon_open_egg_"+Math.floor(Date.now()/36e5)+"_"+n.hatch_id;console.log("sign_message",r);let s=d.address[d.changeAddressIndex].key,g=await new K(s,Q).signMessage(r),y=await d.openEgg(n.hatch_id,t,g);if(console.log(y),y.code==2e4){P();let $="随机幸运属性为："+re[y.data.luckyEle],I="没有抽到奖券。";y.data.ticket>0&&(I="抽到奖券："+y.data.ticket),_e({title:"抽券结果",message:$+"。"+I}).then(()=>{M("onRefresh")})}else P(),X(y.info)},o=async()=>{G({duration:0,message:"操作执行中"});try{let t=d.address[d.changeAddressIndex].address,a=d.address[d.changeAddressIndex].key,r=new K(a,Q);await(await new ue(te.address,te.abi,r).safeTransferFrom(t,T.value,n.id,"0x00")).wait()}catch(t){P(),X(t.toString()),console.log(t),await W(2e3)}await W(1e3),M("onRefresh")},f=async()=>{G({duration:0,message:"出售执行中"});try{let t=d.address[d.changeAddressIndex].address,a=d.address[d.changeAddressIndex].key,r=new K(a,Q),s=new ue(te.address,te.abi,r),e=pe(w.value.toString(),"ether"),g=await ye.getSuggestIndex(t),y=[e,g,n.id,1],$=B.encode(["uint256","uint256","uint256","uint256"],y);await(await s.safeTransferFrom(t,we.address,n.id,$)).wait()}catch(t){P(),X(t.toString()),console.log(t),await W(2e3)}await W(1e3),M("onRefresh")};return(t,a)=>{const r=k("van-tag"),s=k("van-count-down"),e=k("van-button"),g=k("van-cell"),y=k("van-field"),$=k("van-cell-group"),I=k("van-dialog"),F=k("van-picker"),q=k("van-popup");return _(),C(L,null,[h("div",{class:J(["rounded-lg shadow-lg max-w-sm p-1 border-1 text-center","border-"+c(z).find(v=>v.quality==t.dragon.level).color+"-500"])},[h("div",null,[h("span",Ae,p(t.dragon.name),1),l(r,{plain:"",color:c(z).find(v=>v.quality==t.dragon.level).rgb},{default:i(()=>[S(p(c(z).find(v=>v.quality==t.dragon.level).name),1)]),_:1},8,["color"])]),h("div",Ce,"#"+p(t.dragon.id),1),h("div",null,[(_(!0),C(L,null,se(t.dragon.elements,(v,ae)=>(_(),V(r,{class:"mr-1",plain:"",key:ae},{default:i(()=>[S(p(c(re)[v]),1)]),_:2},1024))),128)),h("span",Ee,p(t.dragon.attrs[6])+"/7",1)]),t.dragon.diffTimeStamp>0?(_(),C("div",Ie,[l(s,{class:"text-xs",time:t.dragon.diffTimeStamp,format:"DD 天 HH 时 mm 分 ss 秒"},null,8,["time"])])):O("",!0),t.dragon.state==0&&t.dragon.hatch_id==0&&t.isShowTransfer?(_(),C("div",Te,[l(e,{plain:"",type:"primary",size:"mini",onClick:a[0]||(a[0]=v=>Y())},{default:i(()=>[S(" 出售 ")]),_:1}),l(e,{plain:"",type:"success",size:"mini",class:"ml-2",onClick:a[1]||(a[1]=v=>u())},{default:i(()=>[S(" 转账 ")]),_:1})])):O("",!0),t.dragon.state==0&&t.dragon.hatch_id!=0&&t.isShowTransfer?(_(),C("div",Me,[l(e,{plain:"",type:"primary",size:"small",class:"m-2",onClick:a[2]||(a[2]=v=>b())},{default:i(()=>[S(" 开蛋抽券 ")]),_:1})])):O("",!0),h("div",null,[t.dragon.state==1?(_(),V(r,{key:0,type:"warning"},{default:i(()=>[S("繁殖中")]),_:1})):O("",!0)]),h("div",null,[t.dragon.state==2?(_(),V(r,{key:0,type:"primary"},{default:i(()=>[S("孵化蛋")]),_:1})):O("",!0)])],2),l(I,{show:E.value,"onUpdate:show":a[4]||(a[4]=v=>E.value=v),title:"转账","show-cancel-button":"",onConfirm:o},{default:i(()=>[l($,{inset:""},{default:i(()=>[l(g,{title:"发送昵称",value:c(d).address[c(d).changeAddressIndex].nickname},null,8,["value"]),l(g,{title:"发送地址",value:c(d).address[c(d).changeAddressIndex].address},null,8,["value"]),l(g,{title:"NFT"},{"right-icon":i(()=>[h("div",null,[S(p(t.dragon.name)+" id:"+p(t.dragon.id)+" ",1),l(r,{plain:"",color:c(z).find(v=>v.quality==t.dragon.level).rgb},{default:i(()=>[S(p(c(z).find(v=>v.quality==t.dragon.level).name),1)]),_:1},8,["color"]),S(" "+p(t.dragon.attrs[6])+"/7 ",1)])]),_:1}),l(y,{modelValue:T.value,"onUpdate:modelValue":a[3]||(a[3]=v=>T.value=v),label:"接受地址"},{button:i(()=>[l(e,{size:"small",type:"primary",onClick:N},{default:i(()=>[S("选择")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["show"]),l(I,{show:A.value,"onUpdate:show":a[6]||(a[6]=v=>A.value=v),title:"出售","show-cancel-button":"",onConfirm:f},{default:i(()=>[l($,{inset:""},{default:i(()=>[l(g,{title:"账号昵称",value:c(d).address[c(d).changeAddressIndex].nickname},null,8,["value"]),l(g,{title:"账号地址",value:c(d).address[c(d).changeAddressIndex].address},null,8,["value"]),l(g,{title:"出售NFT"},{"right-icon":i(()=>[h("div",null,[S(p(t.dragon.name)+" id:"+p(t.dragon.id)+" ",1),l(r,{plain:"",color:c(z).find(v=>v.quality==t.dragon.level).rgb},{default:i(()=>[S(p(c(z).find(v=>v.quality==t.dragon.level).name),1)]),_:1},8,["color"]),S(" "+p(t.dragon.attrs[6])+"/7 ",1)])]),_:1}),l(y,{modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=v=>w.value=v),label:"出售价格"},{button:i(()=>[De]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["show"]),l(q,{show:x.value,"onUpdate:show":a[8]||(a[8]=v=>x.value=v),round:"",position:"bottom",teleport:"body"},{default:i(()=>[l(F,{columns:H.value,onCancel:a[7]||(a[7]=v=>x.value=!1),onConfirm:R,onClickOption:R},null,8,["columns"])]),_:1},8,["show"])],64)}}}),He={key:0},Fe={class:"m-2 text-center"},Be={class:"m-2 text-gray-500 text-center text-sm"},Ne={class:"text-gray-800"},Oe={class:"text-gray-400 ml-1 text-xs"},Ye={class:"mt-4 mb-2 text-center"},Re=Z({__name:"DragonBreed",props:{dragons:{}},emits:["onRefresh"],setup(U,{emit:M}){const n=U,m=ee(),B=D(!1),d=D(0),E=D({fa_level:1,ma_level:1,level_1:70,level_2:30,level_3:0,level_4:0}),T=D([{name:"没有可选择的Dragon",disabled:!0,index:-1}]),u=D([-1,-1]),A=D(0),w=()=>{let b=[];for(let o=0;o<n.dragons.length;o++){let f="";for(let s=0;s<n.dragons[o].elements.length;s++)f=f+" "+re[n.dragons[o].elements[s]];let t=z.find(s=>s.quality==n.dragons[o].level).name+" "+n.dragons[o].name+" "+n.dragons[o].attrs[6]+"/7 "+f,a=!1;(o==u.value[0]||o==u.value[1])&&(a=!0,t+=" <已选>");let r=-1;if(u.value[0]>-1&&(r=u.value[0]),u.value[1]>-1&&(r=u.value[1]),r>-1&&r!=o){let s=n.dragons[r];(n.dragons[o].attrs[8]==s.id||n.dragons[o].attrs[9]==s.id)&&(a=!0,t+=" <父母>"),(n.dragons[o].attrs[8]==s.attrs[8]||n.dragons[o].attrs[8]==s.attrs[9]||n.dragons[o].attrs[9]==s.attrs[8]||n.dragons[o].attrs[9]==s.attrs[9])&&(a=!0,t+=" <同代>")}b.push({name:t,disabled:a,index:o})}n.dragons.length>0?T.value=b:T.value=[{name:"没有可选择的Dragon",disabled:!0,index:-1}]},Y=b=>{A.value=b,w(),B.value=!0},x=async b=>{if(u.value[A.value]=b.index,u.value[0]>-1&&u.value[1]>-1){let o=n.dragons[u.value[0]].level,f=n.dragons[u.value[1]].level,t=ce.find(a=>a.fa_level==o&&a.ma_level==f);t||(t=ce.find(a=>a.fa_level==f&&a.ma_level==o)),console.log("res_chance",t),t&&(E.value=t),await H()}},H=async()=>{d.value=0;let b=n.dragons[u.value[0]].level,o=n.dragons[u.value[1]].level,f=n.dragons[u.value[0]].attrs[6],t=n.dragons[u.value[1]].attrs[6],a="0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",r=await j.getBreedPrice(b,o,f,t,a);d.value=r},N=async()=>{const b=G({duration:0,message:"操作执行中"});let o=m.address[m.changeAddressIndex],f=await j.getSuggestIndex(o.address);if(console.log("suggestIndex",f.toString()),f=="255"){P(),X("超出单账号同时繁殖数量！");return}let t=n.dragons[u.value[0]].id,a=n.dragons[u.value[1]].id,r="0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",s=d.value,e=new K(o.key,Q);try{b.message="开始执行繁殖...",await(await j.connect(e).beginBreed(t,a,f,r,s,{value:s})).wait()}catch(g){P(),X(g.toString()),console.log(g),await W(2e3);return}b.message="开始执行孵化...",await R(),u.value=[-1,-1],M("onRefresh")},R=async()=>{let b=m.address[m.changeAddressIndex],o=await j.getHatchData(b.address);for(console.log("hatchData",o.toString());!(o.status=="1"&&o.bHash!=="0x0000000000000000000000000000000000000000000000000000000000000000");)console.log("不符合孵化条件，5秒后再次检测"),await W(5e3),o=await j.getHatchData(b.address);console.log("do end breed!");let f=new K(b.key,Q);await j.connect(f).endBreed()};return ie(()=>{w()}),(b,o)=>{const f=k("van-grid-item"),t=k("van-grid"),a=k("van-button"),r=k("van-cell-group"),s=k("van-action-sheet");return _(),C(L,null,[l(r,{inset:""},{default:i(()=>[l(t,{"column-num":3,class:"pt-5 pb-2"},{default:i(()=>[u.value[0]==-1?(_(),V(f,{key:0,class:"rounded-lg max-w-sm p-1 border-2 text-center",icon:"plus",text:"添加",onClick:o[0]||(o[0]=e=>Y(0))})):O("",!0),u.value[0]>=0?(_(),V(f,{key:1,onClick:o[2]||(o[2]=e=>Y(0))},{default:i(()=>[l(ne,{dragon:n.dragons[u.value[0]],isShowTransfer:!1,onOnRefresh:o[1]||(o[1]=()=>{})},null,8,["dragon"])]),_:1})):O("",!0),l(f,{icon:"like-o",class:"text-gray-400"}),u.value[1]==-1?(_(),V(f,{key:2,class:"rounded-lg max-w-sm p-1 border-2 text-center",icon:"plus",text:"添加",onClick:o[3]||(o[3]=e=>Y(1))})):O("",!0),u.value[1]>=0?(_(),V(f,{key:3,onClick:o[5]||(o[5]=e=>Y(1))},{default:i(()=>[l(ne,{dragon:n.dragons[u.value[1]],isShowTransfer:!1,onOnRefresh:o[4]||(o[4]=()=>{})},null,8,["dragon"])]),_:1})):O("",!0)]),_:1}),u.value[0]>-1&&u.value[1]>-1?(_(),C("div",He,[h("div",Fe,[h("span",{class:J(["text-sm mr-1","text-gray-500"])},"普通 "+p(E.value.level_1.toFixed(1))+"%",1),h("span",{class:J(["text-sm mr-1","text-green-500"])},"良好 "+p(E.value.level_2.toFixed(1))+"%",1),h("span",{class:J(["text-sm mr-1","text-blue-500"])},"稀有 "+p(E.value.level_3.toFixed(1))+"%",1),h("span",{class:J(["text-sm mr-1","text-fuchsia-500"])},"史诗 "+p(E.value.level_4.toFixed(1))+"%",1)]),h("div",Be,[S(" 费用："),h("span",Ne,p(parseFloat(c(de).utils.formatUnits(d.value,"ether")).toFixed(5)),1),S("ETH "),h("span",Oe,"账号余额："+p(c(m).balances.eth.toFixed(5))+"ETH",1)]),h("div",Ye,[l(a,{type:"primary",onClick:N,disabled:!(d.value>0)},{default:i(()=>[S("繁殖")]),_:1},8,["disabled"])])])):O("",!0)]),_:1}),l(s,{show:B.value,"onUpdate:show":o[6]||(o[6]=e=>B.value=e),actions:T.value,title:"选择MoDragon","close-on-click-action":"",onSelect:x,teleport:"body"},null,8,["show","actions"])],64)}}}),Ve={key:0},qe={key:0},Pe={key:1},Ue={key:1},ze={key:2},Le={key:3},je={class:"text-gray-800"},We=h("span",{class:"text-xs text-gray-500"},"MoDragon",-1),Ge=h("span",{class:"text-xs text-gray-500"},"ETH",-1),Je=h("span",{class:"text-xs text-gray-500"},"ARB",-1),Ke=h("span",{class:"text-xs text-gray-500"},"MBOX",-1),Qe={class:"m-2"},Xe={class:"text-lg text-gray-500 ml-3"},Ze={class:"grid grid-cols-3 md:lg:xl:grid-cols-6 group bg-white shadow-xl shadow-neutral-100 border"},et=h("div",{class:"m-2"},[h("span",{class:"text-lg text-gray-500 ml-3"},"繁殖操作")],-1),tt={class:"m-2"},st={class:"text-lg text-gray-500 ml-3"},nt={class:"grid grid-cols-3 md:lg:xl:grid-cols-6 group bg-white shadow-xl shadow-neutral-100 border"},at=Z({__name:"account",setup(U){ge.extend(Se);const{onActivated:M}=$e(),n=ee(),m=D([]),B=D([]);ke(()=>[n.address,n.changeAddressIndex],async(E,T)=>{await d(),await n.getChangeAddressBalance()}),M(async({address:E})=>{await d(),await n.getChangeAddressBalance()}),ie(async()=>{await d(),await n.getChangeAddressBalance()});async function d(){if(G({duration:0,forbidClick:!0,message:"更新数据"}),n.address.length==0||n.changeAddressIndex<0){P();return}let E=await n.upOneAddressNft(n.changeAddressIndex);m.value=E.nfts,B.value=E.nfts.filter(T=>T.state==0&&T.hatch_id==0),P()}return(E,T)=>{const u=k("van-notice-bar"),A=k("van-empty"),w=k("van-grid-item"),Y=k("van-grid");return _(),C(L,null,[c(de).utils.isHexString(c(n).address[c(n).changeAddressIndex].key,32)==!0?(_(),C("div",Ve,[c(de).utils.computeAddress(c(n).address[c(n).changeAddressIndex].key)!=c(n).address[c(n).changeAddressIndex].address?(_(),C("div",qe,[l(u,{mode:"closeable"},{default:i(()=>[S("账号"+p(c(le)(c(n).address[c(n).changeAddressIndex].address))+"公私钥不匹配！",1)]),_:1})])):(_(),C("div",Pe))])):(_(),C("div",Ue,[l(u,{mode:"closeable"},{default:i(()=>[S("账号"+p(c(le)(c(n).address[c(n).changeAddressIndex].address))+"为观察模式状态！",1)]),_:1})])),m.value.length==0?(_(),C("div",ze,[l(A,{image:"search",description:"没有发现龙蛋NFT"})])):O("",!0),m.value.length>0?(_(),C("div",Le,[l(Y,{class:"m-2","column-num":4},{default:i(()=>[l(w,null,{icon:i(()=>[h("span",je,p(m.value.length),1)]),text:i(()=>[We]),_:1}),l(w,null,{icon:i(()=>[h("span",null,p(c(n).balances.eth.toFixed(2)),1)]),text:i(()=>[Ge]),_:1}),l(w,null,{icon:i(()=>[h("span",null,p(c(n).balances.arb.toFixed(0)),1)]),text:i(()=>[Je]),_:1}),l(w,null,{icon:i(()=>[h("span",null,p(c(n).balances.mbox.toFixed(0)),1)]),text:i(()=>[Ke]),_:1})]),_:1}),h("div",Qe,[h("span",Xe,"空闲状态: "+p(m.value.filter(x=>x.state==0).length),1)]),h("div",Ze,[(_(!0),C(L,null,se(m.value.filter(x=>x.state==0),(x,H)=>(_(),C("div",{key:"dragon0"+H+x.id,class:"m-3"},[l(ne,{dragon:x,isShowTransfer:!0,onOnRefresh:d},null,8,["dragon"])]))),128))]),et,(_(),V(Re,{dragons:B.value,key:c(n).address[c(n).changeAddressIndex].address,onOnRefresh:d},null,8,["dragons"])),h("div",tt,[h("span",st,"繁殖状态: "+p(m.value.filter(x=>x.state>0).length),1)]),h("div",nt,[(_(!0),C(L,null,se(m.value.filter(x=>x.state>0),(x,H)=>(_(),C("div",{key:"dragon"+H,class:"m-3"},[l(ne,{dragon:x,isShowTransfer:!1,onOnRefresh:d},null,8,["dragon"])]))),128))])])):O("",!0)],64)}}}),ot={key:0},rt={class:"text-gray-600 text-sm ml-1"},lt=h("span",null,null,-1),dt=h("span",{class:"ml-5 text-gray-500"},"最近一次繁殖结束： ",-1),it={key:1},ut=Z({__name:"collect",setup(U){const M=ee(),n=D(!1),m=D(0),B=[{text:"空闲数量降序",value:0},{text:"孵蛋时间降序",value:1},{text:"账号顺序降序",value:2}],d=()=>{switch(console.log(m.value),m.value){case 0:M.nftinfos.sort((u,A)=>A.nfts.filter(w=>w.state==0).length-u.nfts.filter(w=>w.state==0).length);break;case 1:M.nftinfos.sort((u,A)=>u.nfts.findIndex(w=>w.state>0)==-1?1:A.nfts.findIndex(w=>w.state>0)==-1?-1:u.nfts.find(w=>w.state>0).attrs[7]-A.nfts.find(w=>w.state>0).attrs[7]);break;case 2:M.nftinfos.sort((u,A)=>u.id-A.id);break}};ie(()=>{M.getLocalNftinfos()});const E=async()=>{G({duration:0,forbidClick:!0,message:"更新数据"}),n.value=!0,await M.upAllAddressNfts(),d(),n.value=!1,console.log("更新状态"),P()},T={dropdownMenuHeight:"36px"};return(u,A)=>{const w=k("van-button"),Y=k("van-dropdown-item"),x=k("van-dropdown-menu"),H=k("van-config-provider"),N=k("van-cell"),R=k("van-tag"),b=k("van-cell-group"),o=k("van-empty");return c(M).address.length>0?(_(),C("div",ot,[l(b,{class:"my-2",inset:""},{default:i(()=>[l(N,{title:"各账号详情",icon:"user-o"},{value:i(()=>[l(w,{type:"success",size:"mini",class:"mr-2",loading:n.value,"loading-text":"读取中",onClick:E},{default:i(()=>[S(" 更新数据 ")]),_:1},8,["loading"])]),extra:i(()=>[l(H,{"theme-vars":T},{default:i(()=>[l(x,null,{default:i(()=>[l(Y,{modelValue:m.value,"onUpdate:modelValue":A[0]||(A[0]=f=>m.value=f),options:B,onChange:d},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(_(!0),C(L,null,se(c(M).nftinfos,(f,t)=>(_(),C(L,{key:t+f.address},[l(N,null,{title:i(()=>[l(R,{round:"",plain:"",type:"primary"},{default:i(()=>[S(p(f.id+1),1)]),_:2},1024),h("span",rt,p(f.nickname),1),lt]),value:i(()=>[S(" 空闲:"+p(f.nfts.filter(a=>a.state==0).length)+"/繁殖:"+p(f.nfts.filter(a=>a.state>0).length),1)]),_:2},1024),f.nfts.findIndex(a=>a.state>0)!=-1?(_(),V(N,{key:0},{title:i(()=>[dt]),value:i(()=>[S(p(c(ge).unix(f.nfts.find(a=>a.state>0).attrs[7]).format("MM/DDTHH:mm")),1)]),_:2},1024)):O("",!0)],64))),128))]),_:1})])):(_(),C("div",it,[l(o,{description:"账号数量为空"})]))}}}),gt=Z({__name:"index",setup(U){const M=ee();return(n,m)=>c(M).changeAddressIndex>=0?(_(),V(at,{key:0})):(_(),V(ut,{key:1}))}});export{gt as default};
